<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>听课评估表 - Class Observation Report</title>
    <style>
        /* =========================== */
        /* 屏幕显示样式 */
        /* =========================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'SimSun', Arial, sans-serif;
            background-color: #f8fafc;
            color: #000;
            font-size: 14px;
            line-height: 1.4;
        }

        .screen-only {
            display: block;
        }

        .print-only {
            display: none;
        }

        /* 顶部操作栏 */
        .action-bar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .action-bar-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-screen {
            height: 50px;
        }

        .title-group h1 {
            font-size: 22px;
            color: #1e3a5f;
            margin-bottom: 3px;
        }

        .title-group p {
            font-size: 14px;
            color: #64748b;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 18px;
            border: 1px solid #cbd5e1;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .btn:hover {
            background: #f1f5f9;
        }

        .btn-primary {
            background: #1e3a5f;
            color: white;
            border-color: #1e3a5f;
        }

        .btn-primary:hover {
            background: #2d4a6f;
        }

        .btn svg {
            width: 18px;
            height: 18px;
        }

        /* 主容器 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
            padding: 30px;
            margin-bottom: 25px;
        }

        /* 屏幕版布局 */
        .print-border-wrapper {
            border: 2px solid #1e3a5f;
            border-radius: 5px;
            padding: 20px;
            position: relative;
            background: white;
        }

        .print-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #1e3a5f;
            padding-bottom: 12px;
            margin-bottom: 15px;
        }

        .print-logo {
            height: 50px;
        }

        .print-slogan {
            font-size: 10px;
            color: #666;
            text-align: right;
            font-style: italic;
            max-width: 250px;
            line-height: 1.3;
        }

        .doc-title {
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 15px;
            color: #1e3a5f;
        }

        /* 两栏布局 */
        .two-column-layout {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .left-sidebar {
            width: 160px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
        }

        /* 左侧栏 */
        .sidebar-title {
            font-size: 18px;
            font-weight: bold;
            color: #1e3a5f;
            margin-bottom: 4px;
            line-height: 1.2;
        }

        .sidebar-title-cn {
            font-size: 16px;
            font-weight: bold;
            color: #1e3a5f;
            margin-bottom: 12px;
        }

        .checkbox-icon {
            width: 80px;
            height: 80px;
            border: 2px solid #1e3a5f;
            background: #f0f4f8;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            position: relative;
        }

        .checkbox-icon::before {
            content: "✓\A✓\A✓";
            white-space: pre;
            font-size: 24px;
            color: #1e3a5f;
            font-weight: bold;
            line-height: 1.2;
        }

        .comments-label {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .comments-box {
            border: 2px solid #333;
            flex: 1;
            padding: 10px;
            font-size: 12px;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            min-height: 200px;
            margin-bottom: 15px;
        }

        .comments-box textarea {
            width: 100%;
            flex: 1;
            border: none;
            font-size: 12px;
            font-family: inherit;
            resize: none;
            outline: none;
            overflow: hidden;
        }

        /* 信息表格 */
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 12px;
            font-size: 12px;
        }

        .info-table th,
        .info-table td {
            border: 1px solid #333;
            padding: 6px 8px;
            text-align: left;
            vertical-align: middle;
        }

        .info-table th {
            background: #f5f5f5;
            font-weight: bold;
            white-space: nowrap;
            width: 22%;
        }

        .info-header {
            background: #1e3a5f !important;
            color: white;
            text-align: center;
            font-weight: bold;
            padding: 8px;
        }

        .info-table input {
            width: 100%;
            padding: 4px 6px;
            border: 1px solid #cbd5e1;
            border-radius: 3px;
            font-size: 12px;
            box-sizing: border-box;
        }

        .note {
            font-size: 11px;
            color: #666;
            font-style: italic;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        /* 评估表格 */
        .assessment-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin-bottom: 10px;
        }

        .assessment-table th,
        .assessment-table td {
            border: 1px solid #333;
            padding: 4px 6px;
            text-align: left;
            vertical-align: top;
            line-height: 1.3;
        }

        .assessment-table thead th {
            background: #e8e8e8;
            font-weight: bold;
        }

        .section-header {
            background: #1e3a5f !important;
            color: white;
            text-align: center;
            font-weight: bold;
            padding: 6px;
            font-size: 12px;
        }

        .item-text {
            font-size: 11px;
            line-height: 1.3;
            color: #000000; /* 确保屏幕显示为黑色 */
        }

        .item-desc {
            font-size: 10px;
            color: #000000; /* 确保屏幕显示为黑色 */
            line-height: 1.3;
            margin-top: 2px;
        }

        .band-col {
            text-align: center;
            width: 50px;
        }

        .score-col {
            width: 70px;
            text-align: center;
        }

        .score-select {
            width: 100%;
            padding: 4px;
            border: 1px solid #cbd5e1;
            border-radius: 3px;
            font-size: 11px;
            text-align: center;
            box-sizing: border-box;
        }

        .na-checkbox {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            font-size: 10px;
            color: #666;
            margin-top: 3px;
        }

        .na-checkbox input {
            width: 14px;
            height: 14px;
        }

        .total-row {
            background: #f0f0f0;
            font-weight: bold;
        }

        /* 百分比 */
        .percentage-row {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            font-size: 14px;
            font-weight: bold;
            margin-top: 8px;
        }

        .percentage-box {
            border: 2px solid #333;
            padding: 5px 12px;
            margin-left: 10px;
            min-width: 55px;
            text-align: center;
            font-size: 14px;
        }

        /* 页脚 */
        .footer {
            font-size: 9px;
            color: #666;
            border-top: 1px solid #ccc;
            padding-top: 10px;
            margin-top: 15px;
            line-height: 1.4;
        }

        .footer-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2px;
        }

        .footer-phone {
            white-space: nowrap;
            margin-left: 15px;
        }

        /* =========================== */
        /* 打印样式 - A4单页布局 */
        /* =========================== */
        @media print {
            /* 隐藏所有屏幕元素 */
            .screen-only {
                display: none !important;
            }
            
            .action-bar {
                display: none !important;
            }
            
            .container {
                width: 100% !important;
                max-width: 100% !important;
                padding: 0 !important;
                margin: 0 !important;
                box-shadow: none !important;
                background: white !important;
            }
            
            .card {
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin: 0 !important;
                background: white !important;
            }
            
            /* 创建A4布局容器 */
            .print-a4-layout {
                display: block !important;
                width: 210mm !important;
                height: 297mm !important;
                margin: 0 auto !important;
                padding: 15mm 12mm !important;
                background: white !important;
                box-sizing: border-box !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                position: relative !important;
            }
            
            /* 添加外边框 */
            .print-a4-layout::before {
                content: '';
                position: absolute !important;
                top: 10mm !important;
                left: 8mm !important;
                right: 8mm !important;
                bottom: 10mm !important;
                border: 3px solid #1e3a5f !important;
                border-radius: 8px !important;
                pointer-events: none !important;
                z-index: 1 !important;
            }
            
            /* 打印头部 */
            .print-a4-header {
                display: flex !important;
                justify-content: space-between !important;
                align-items: center !important;
                border-bottom: 2px solid #1e3a5f !important;
                padding-bottom: 8px !important;
                margin-bottom: 12px !important;
                position: relative !important;
                z-index: 2 !important;
            }
            
            .print-a4-logo {
                height: 45px !important;
                max-height: 45px !important;
            }
            
            .print-a4-slogan {
                font-size: 9px !important;
                color: #666 !important;
                text-align: right !important;
                font-style: italic !important;
                max-width: 220px !important;
                line-height: 1.3 !important;
            }
            
            /* 文档标题 */
            .print-a4-doc-title {
                font-size: 16px !important;
                font-weight: bold !important;
                text-align: center !important;
                margin-bottom: 15px !important;
                color: #1e3a5f !important;
                position: relative !important;
                z-index: 2 !important;
            }
            
            /* A4两栏布局 */
            .print-a4-two-column {
                display: flex !important;
                gap: 15px !important;
                margin-bottom: 15px !important;
                height: 180mm !important;
                overflow: hidden !important;
                position: relative !important;
                z-index: 2 !important;
            }
            
            /* A4左侧栏 */
            .print-a4-left-sidebar {
                width: 150px !important;
                flex-shrink: 0 !important;
                display: flex !important;
                flex-direction: column !important;
            }
            
            .print-a4-sidebar-title {
                font-size: 18px !important;
                font-weight: bold !important;
                color: #1e3a5f !important;
                margin-bottom: 5px !important;
                line-height: 1.2 !important;
            }
            
            .print-a4-sidebar-title-cn {
                font-size: 16px !important;
                font-weight: bold !important;
                color: #1e3a5f !important;
                margin-bottom: 15px !important;
            }
            
            .print-a4-checkbox-icon {
                width: 70px !important;
                height: 70px !important;
                border: 2px solid #1e3a5f !important;
                background: #f0f4f8 !important;
                border-radius: 8px !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                margin-bottom: 20px !important;
                position: relative !important;
            }
            
            .print-a4-checkbox-icon::before {
                content: "✓\A✓\A✓" !important;
                white-space: pre !important;
                font-size: 22px !important;
                color: #1e3a5f !important;
                font-weight: bold !important;
                line-height: 1.2 !important;
            }
            
            .print-a4-comments-label {
                font-weight: bold !important;
                font-size: 12px !important;
                margin-bottom: 5px !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-comments-box {
                border: 2px solid #333 !important;
                flex: 1 !important;
                padding: 10px !important;
                font-size: 11px !important;
                border-radius: 4px !important;
                display: flex !important;
                flex-direction: column !important;
                min-height: 180px !important;
                margin-bottom: 15px !important;
            }
            
            /* A4主内容区域 */
            .print-a4-main-content {
                flex: 1 !important;
                min-width: 0 !important;
                display: flex !important;
                flex-direction: column !important;
                overflow: hidden !important;
            }
            
            /* A4信息表格 */
            .print-a4-info-table {
                width: 100% !important;
                border-collapse: collapse !important;
                margin-bottom: 10px !important;
                font-size: 11px !important;
                table-layout: fixed !important;
            }
            
            .print-a4-info-table th,
            .print-a4-info-table td {
                border: 1px solid #333 !important;
                padding: 5px 6px !important;
                text-align: left !important;
                vertical-align: middle !important;
                line-height: 1.2 !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-info-table th {
                background: #f5f5f5 !important;
                font-weight: bold !important;
                white-space: nowrap !important;
                width: 22% !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-info-header {
                background: #1e3a5f !important;
                color: white !important;
                text-align: center !important;
                font-weight: bold !important;
                padding: 6px !important;
            }
            
            /* A4评估表格 - 所有字体设置为纯黑色 */
            .print-a4-assessment-table {
                width: 100% !important;
                border-collapse: collapse !important;
                font-size: 10px !important;
                margin-bottom: 8px !important;
                flex: 1 !important;
                table-layout: fixed !important;
                max-height: 130mm !important;
                overflow: hidden !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-assessment-table th,
            .print-a4-assessment-table td {
                border: 1px solid #333 !important;
                padding: 4px 5px !important;
                text-align: left !important;
                vertical-align: top !important;
                line-height: 1.2 !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-assessment-table thead th {
                background: #e8e8e8 !important;
                font-weight: bold !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-section-header {
                background: #1e3a5f !important;
                color: white !important;
                text-align: center !important;
                font-weight: bold !important;
                padding: 5px !important;
                font-size: 11px !important;
            }
            
            .print-a4-item-text {
                font-size: 10px !important;
                line-height: 1.2 !important;
                color: #000000 !important; /* 纯黑色 */
            }
            
            .print-a4-item-desc {
                font-size: 9px !important;
                color: #000000 !important; /* 纯黑色 */
                line-height: 1.2 !important;
                margin-top: 2px !important;
            }
            
            .print-a4-band-col {
                text-align: center !important;
                width: 45px !important;
            }
            
            .print-a4-score-col {
                width: 60px !important;
                text-align: center !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-total-row {
                background: #f0f0f0 !important;
                font-weight: bold !important;
                color: #000000 !important; /* 黑色 */
            }
            
            /* A4百分比 */
            .print-a4-percentage-row {
                display: flex !important;
                justify-content: flex-end !important;
                align-items: center !important;
                font-size: 13px !important;
                font-weight: bold !important;
                margin-top: 5px !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-percentage-box {
                border: 2px solid #333 !important;
                padding: 4px 10px !important;
                margin-left: 8px !important;
                min-width: 50px !important;
                text-align: center !important;
                font-size: 13px !important;
                color: #000000 !important; /* 黑色 */
            }
            
            /* A4页脚 */
            .print-a4-footer {
                font-size: 8px !important;
                color: #666 !important;
                border-top: 1px solid #ccc !important;
                padding-top: 8px !important;
                margin-top: 12px !important;
                line-height: 1.3 !important;
                position: relative !important;
                z-index: 2 !important;
            }
            
            .print-a4-footer-row {
                display: flex !important;
                justify-content: space-between !important;
                margin-bottom: 1px !important;
                color: #000000 !important; /* 黑色 */
            }
            
            .print-a4-footer-phone {
                white-space: nowrap !important;
                margin-left: 12px !important;
            }
            
            /* 隐藏屏幕布局元素 */
            .print-border-wrapper,
            .two-column-layout,
            .footer {
                display: none !important;
            }
            
            /* 显示打印元素 */
            .print-only {
                display: block !important;
            }
            
            /* 设置页面 */
            @page {
                size: A4 portrait;
                margin: 0 !important;
            }
            
            body {
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
                width: 210mm !important;
                height: 297mm !important;
                overflow: hidden !important;
            }
            
            /* 确保所有内容可见 */
            .print-a4-layout * {
                visibility: visible !important;
            }
            
            /* 输入框打印样式 */
            input, textarea, select {
                border: 1px solid #ccc !important;
                background: transparent !important;
                font-size: inherit !important;
                font-family: inherit !important;
                color: #000000 !important; /* 黑色 */
            }
            
            /* 隐藏屏幕控件 */
            .score-select,
            .na-checkbox {
                display: none !important;
            }
            
            /* 确保注释文本为黑色 */
            .note {
                color: #000000 !important; /* 黑色 */
            }
        }
    </style>
</head>
<body>
    <!-- 顶部操作栏（仅屏幕显示） -->
    <div class="action-bar screen-only">
        <div class="action-bar-content">
            <div class="header-info">
                <img src="logo.png" alt="英领国际学校" class="logo-screen">
                <div class="title-group">
                    <h1>听课评估表</h1>
                    <p>Class Observation Report</p>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn" onclick="resetForm()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    重置
                </button>
                <button class="btn" onclick="window.print()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                    </svg>
                    打印
                </button>
                <button class="btn btn-primary" onclick="exportPDF()">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    导出PDF
                </button>
            </div>
        </div>
    </div>

    <!-- 主内容 -->
    <div class="container">
        <div class="card">
            <!-- 屏幕版布局 -->
            <div class="print-border-wrapper screen-only">
                <!-- 打印头部（包含logo） -->
                <div class="print-header">
                    <img src="logo.png" alt="英领国际学校" class="print-logo">
                    <div class="print-slogan">CULTIVATE AN INDIVIDUAL WITH INDIGENOUS SPIRIT AND DECOROUS MANNER</div>
                </div>

                <!-- 文档标题 -->
                <div class="doc-title">听课评估表</div>

                <!-- 两栏布局 -->
                <div class="two-column-layout">
                    <!-- 左侧栏 -->
                    <div class="left-sidebar">
                        <div class="sidebar-title">Class Observation</div>
                        <div class="sidebar-title">Report</div>
                        <div class="sidebar-title-cn">听课评估表</div>
                        
                        <div class="checkbox-icon"></div>
                        
                        <div class="comments-label">Comments：</div>
                        <div class="comments-label">听课意见及建议：</div>
                        <div class="comments-box">
                            <textarea id="comments" oninput="saveData()"></textarea>
                        </div>
                    </div>

                    <!-- 右侧主内容 -->
                    <div class="main-content">
                        <!-- 信息表格 -->
                        <table class="info-table">
                            <tr>
                                <th colspan="4" class="info-header">Class observation info 听课信息</th>
                            </tr>
                            <tr>
                                <th>Observer 听课人姓名：</th>
                                <td><input type="text" id="observer" oninput="saveData()"></td>
                                <th>Date 听课日期：</th>
                                <td><input type="date" id="date" oninput="saveData()"></td>
                            </tr>
                            <tr>
                                <th>Teacher 授课教师：</th>
                                <td colspan="3"><input type="text" id="teacher" oninput="saveData()"></td>
                            </tr>
                            <tr>
                                <th>Class 听课班级：</th>
                                <td><input type="text" id="className" oninput="saveData()"></td>
                                <th>Subject 授课科目：</th>
                                <td><input type="text" id="subject" oninput="saveData()"></td>
                            </tr>
                            <tr>
                                <th>Lecture topic 教学主题：</th>
                                <td colspan="3"><input type="text" id="topic" oninput="saveData()"></td>
                            </tr>
                        </table>

                        <div class="note">注：本评估表的评估依据为2023年9月英领国际学校教研院出台的"英领新课标"。</div>

                        <!-- 评估表格 -->
                        <table class="assessment-table">
                            <thead>
                                <tr>
                                    <th>Assessment criteria 评估标准</th>
                                    <th class="band-col">Band</th>
                                    <th class="score-col">Score</th>
                                </tr>
                            </thead>
                            <tbody id="assessmentBody">
                                <!-- 由JavaScript生成 -->
                            </tbody>
                        </table>

                        <!-- 百分比 -->
                        <div class="percentage-row">
                            <span>百分比</span>
                            <div class="percentage-box" id="percentageValue">100</div>
                        </div>
                    </div>
                </div>

                <!-- 页脚 -->
                <div class="footer">
                    <div class="footer-row">
                        <span>Dalian New Airport Main School Address: Northside of the Quanguan Sport Park, Ganjingzi District, Dalian, Liaoning Province</span>
                        <span class="footer-phone">Phone Number: 0411-39789866</span>
                    </div>
                    <div class="footer-row">
                        <span>Dalian Shahekou Branch School Address: 14 E Modern Service Building, 620 Huanghelu, Shahekou, Dalian, Liaoning Province</span>
                        <span class="footer-phone">Phone Number: 0411-39789866</span>
                    </div>
                    <div class="footer-row">
                        <span>Dalian Teenager Campus Address: No.18-19 Shuma Road North Shuma Square, Shahekou District, Dalian, Liaoning Province</span>
                        <span class="footer-phone">Phone Number: 0411-39585511</span>
                    </div>
                    <div class="footer-row">
                        <span>Shenyang Branch School Address: Building A No. 15 Maoye centre No.185 Qingnian Street, Shenghe District, Shenyang, Liaoning Province</span>
                        <span class="footer-phone">Phone Number: 024-31808858</span>
                    </div>
                    <div class="footer-row">
                        <span>Nanjing Branch School Address: No. 239 Baota Road, Gaochun District, Nanjing, Jiangsu Province</span>
                        <span class="footer-phone">Phone Number: 025-57336701</span>
                    </div>
                </div>
            </div>
            
            <!-- =========================== -->
            <!-- 打印版布局（A4单页） -->
            <!-- =========================== -->
            <div class="print-a4-layout print-only">
                <!-- 打印头部 -->
                <div class="print-a4-header">
                    <img src="logo.png" alt="英领国际学校" class="print-a4-logo">
                    <div class="print-a4-slogan">CULTIVATE AN INDIVIDUAL WITH INDIGENOUS SPIRIT AND DECOROUS MANNER</div>
                </div>

                <!-- 文档标题 -->
                <div class="print-a4-doc-title">听课评估表</div>

                <!-- 两栏布局 -->
                <div class="print-a4-two-column">
                    <!-- 左侧栏 -->
                    <div class="print-a4-left-sidebar">
                        <div class="print-a4-sidebar-title">Class Observation</div>
                        <div class="print-a4-sidebar-title">Report</div>
                        <div class="print-a4-sidebar-title-cn">听课评估表</div>
                        
                        <div class="print-a4-checkbox-icon"></div>
                        
                        <div class="print-a4-comments-label">Comments：</div>
                        <div class="print-a4-comments-label">听课意见及建议：</div>
                        <div class="print-a4-comments-box">
                            <!-- 注释框内容将由JavaScript填充 -->
                            <div id="print-a4-comments-content"></div>
                        </div>
                    </div>

                    <!-- 右侧主内容 -->
                    <div class="print-a4-main-content">
                        <!-- 信息表格 -->
                        <table class="print-a4-info-table">
                            <tr>
                                <th colspan="4" class="print-a4-info-header">Class observation info 听课信息</th>
                            </tr>
                            <tr>
                                <th>Observer 听课人姓名：</th>
                                <td id="print-a4-observer"></td>
                                <th>Date 听课日期：</th>
                                <td id="print-a4-date"></td>
                            </tr>
                            <tr>
                                <th>Teacher 授课教师：</th>
                                <td colspan="3" id="print-a4-teacher"></td>
                            </tr>
                            <tr>
                                <th>Class 听课班级：</th>
                                <td id="print-a4-className"></td>
                                <th>Subject 授课科目：</th>
                                <td id="print-a4-subject"></td>
                            </tr>
                            <tr>
                                <th>Lecture topic 教学主题：</th>
                                <td colspan="3" id="print-a4-topic"></td>
                            </tr>
                        </table>

                        <div class="note" style="font-size: 10px !important; margin-bottom: 8px !important; color: #000000 !important;">注：本评估表的评估依据为2023年9月英领国际学校教研院出台的"英领新课标"。</div>

                        <!-- 评估表格 -->
                        <table class="print-a4-assessment-table">
                            <thead>
                                <tr>
                                    <th>Assessment criteria 评估标准</th>
                                    <th class="print-a4-band-col">Band</th>
                                    <th class="print-a4-score-col">Score</th>
                                </tr>
                            </thead>
                            <tbody id="print-a4-assessmentBody">
                                <!-- 由JavaScript生成 -->
                            </tbody>
                        </table>

                        <!-- 百分比 -->
                        <div class="print-a4-percentage-row">
                            <span>百分比</span>
                            <div class="print-a4-percentage-box" id="print-a4-percentageValue">100</div>
                        </div>
                    </div>
                </div>

                <!-- 页脚 -->
                <div class="print-a4-footer">
                    <div class="print-a4-footer-row">
                        <span>Dalian New Airport Main School Address: Northside of the Quanguan Sport Park, Ganjingzi District, Dalian, Liaoning Province</span>
                        <span class="print-a4-footer-phone">Phone Number: 0411-39789866</span>
                    </div>
                    <div class="print-a4-footer-row">
                        <span>Dalian Shahekou Branch School Address: 14 E Modern Service Building, 620 Huanghelu, Shahekou, Dalian, Liaoning Province</span>
                        <span class="print-a4-footer-phone">Phone Number: 0411-39789866</span>
                    </div>
                    <div class="print-a4-footer-row">
                        <span>Dalian Teenager Campus Address: No.18-19 Shuma Road North Shuma Square, Shahekou District, Dalian, Liaoning Province</span>
                        <span class="print-a4-footer-phone">Phone Number: 0411-39585511</span>
                    </div>
                    <div class="print-a4-footer-row">
                        <span>Shenyang Branch School Address: Building A No. 15 Maoye centre No.185 Qingnian Street, Shenghe District, Shenyang, Liaoning Province</span>
                        <span class="print-a4-footer-phone">Phone Number: 024-31808858</span>
                    </div>
                    <div class="print-a4-footer-row">
                        <span>Nanjing Branch School Address: No. 239 Baota Road, Gaochun District, Nanjing, Jiangsu Province</span>
                        <span class="print-a4-footer-phone">Phone Number: 025-57336701</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 评估数据
        const assessmentData = [
            {
                title: "Assessment 1 – Teacher's work ethics 教师基本素养评判",
                items: [
                    { 
                        id: 'a1_1', 
                        text: "1. Teacher's behaviour？ 教师行为规范？", 
                        desc: "按时上课，不提前下课，衣着得体，不坐着上课，用语文明，不讨论与课堂无关内容，不接打电话，不以大量学生练习时间代替授课时间。", 
                        band: 10 
                    },
                    { 
                        id: 'a1_2', 
                        text: "2. Classroom management? 课堂学生管理？", 
                        desc: "制止学生课堂上睡觉，吃东西，玩电子设备，随意讲话打闹，做与本课无关的事情，纠正学生所发表的不当言论。", 
                        band: 10 
                    }
                ]
            },
            {
                title: "Assessment 2 – PAS (Preparation, Assignment, Support) 课前及课后",
                items: [
                    { id: 'a2_1', text: "1. Preparation？ 教师对本节课的准备是否充分？", band: 5 },
                    { id: 'a2_2', text: "2. Class presentation? 课件和板书设计是否合理？", band: 5 },
                    { id: 'a2_3', text: "3. Homework? 课后作业布置的内容是否合理？", band: 5 },
                    { id: 'a2_4', text: "4. Preview assignment? 是否布置了预习的内容？", band: 5 }
                ]
            },
            {
                title: "Assessment 3 – LIDAS (Lead-in, Instruct, Dialogue, Activity, Sum-up) 教学过程",
                items: [
                    { id: 'a3_1', text: "1. Lead-in？ 是否设计了导入环节或预习检验？内容是否合理？", band: 5 },
                    { id: 'a3_2', text: "2. Sum-up? 课程末端是否非常好的总结了该节课的主要内容？", band: 5 },
                    { id: 'a3_3', text: "3. Pronunciation and accuracy? 语言（双语）表达是否准确？", band: 10 },
                    { id: 'a3_4', text: "4. Activity? 课堂是否设计了课堂活动？设计是否合理？", band: 10 }
                ]
            },
            {
                title: "Assessment 4 - International class standards 国际课程质量标准",
                items: [
                    { id: 'a4_1', text: "1. International-mindedness? 该节课是否有效拓展了学生们的视野？", band: 5 },
                    { id: 'a4_2', text: "2. Intriguing? 该节课是否有效地激发了学生对该学科的兴趣？", band: 5 },
                    { id: 'a4_3', text: "3. Interactive? 该节课是否和学生形成了有效的互动？", band: 10 },
                    { id: 'a4_4', text: "4. Independent? 该节课是否培养了学生独立思考的能力？", band: 10 }
                ]
            }
        ];

        // 初始化评估表格
        function initAssessmentTable() {
            const tbody = document.getElementById('assessmentBody');
            const printTbody = document.getElementById('print-a4-assessmentBody');
            let html = '';
            let printHtml = '';

            assessmentData.forEach(section => {
                html += `<tr><td colspan="3" class="section-header">${section.title}</td></tr>`;
                printHtml += `<tr><td colspan="3" class="print-a4-section-header">${section.title}</td></tr>`;

                section.items.forEach(item => {
                    html += `
                        <tr>
                            <td>
                                <div class="item-text">${item.text}</div>
                                ${item.desc ? `<div class="item-desc">${item.desc}</div>` : ''}
                            </td>
                            <td class="band-col">
                                <span id="band_${item.id}">${item.band}</span>
                            </td>
                            <td class="score-col">
                                <div class="screen-only">
                                    <select class="score-select" id="score_${item.id}" onchange="handleScoreChange('${item.id}', ${item.band})">
                                        <option value="">选择分数</option>
                                        ${generateScoreOptions(item.band)}
                                    </select>
                                    <label class="na-checkbox">
                                        <input type="checkbox" id="na_${item.id}" onchange="handleNAChange('${item.id}', ${item.band})">
                                        不适用
                                    </label>
                                </div>
                                <span class="print-only" id="print_score_${item.id}"></span>
                            </td>
                        </tr>
                    `;
                    
                    printHtml += `
                        <tr>
                            <td>
                                <div class="print-a4-item-text">${item.text}</div>
                                ${item.desc ? `<div class="print-a4-item-desc">${item.desc}</div>` : ''}
                            </td>
                            <td class="print-a4-band-col">
                                <span id="print_a4_band_${item.id}">${item.band}</span>
                            </td>
                            <td class="print-a4-score-col">
                                <span id="print_a4_score_${item.id}"></span>
                            </td>
                        </tr>
                    `;
                });
            });

            html += `
                <tr class="total-row">
                    <td>Total score 得分总和</td>
                    <td class="band-col"><span id="totalBand">100</span></td>
                    <td class="score-col"><span id="totalScore">0</span></td>
                </tr>
            `;
            
            printHtml += `
                <tr class="print-a4-total-row">
                    <td>Total score 得分总和</td>
                    <td class="print-a4-band-col"><span id="print_a4_totalBand">100</span></td>
                    <td class="print-a4-score-col"><span id="print_a4_totalScore">0</span></td>
                </tr>
            `;

            tbody.innerHTML = html;
            printTbody.innerHTML = printHtml;
            loadData();
        }

        // 生成分数选项
        function generateScoreOptions(band) {
            let options = '';
            for (let i = 0; i <= band; i++) {
                options += `<option value="${i}">${i}</option>`;
            }
            return options;
        }

        // 处理分数变化
        function handleScoreChange(itemId, band) {
            const naCheckbox = document.getElementById(`na_${itemId}`);
            const scoreSelect = document.getElementById(`score_${itemId}`);
            const printScore = document.getElementById(`print_score_${itemId}`);
            const printA4Score = document.getElementById(`print_a4_score_${itemId}`);
            
            if (scoreSelect.value !== '') {
                naCheckbox.checked = false;
                printScore.textContent = scoreSelect.value;
                if (printA4Score) printA4Score.textContent = scoreSelect.value;
            } else {
                printScore.textContent = '';
                if (printA4Score) printA4Score.textContent = '';
            }
            
            calculateResults();
            saveData();
        }

        // 处理不适用变化
        function handleNAChange(itemId, band) {
            const naCheckbox = document.getElementById(`na_${itemId}`);
            const scoreSelect = document.getElementById(`score_${itemId}`);
            const bandDisplay = document.getElementById(`band_${itemId}`);
            const printScore = document.getElementById(`print_score_${itemId}`);
            const printA4Band = document.getElementById(`print_a4_band_${itemId}`);
            const printA4Score = document.getElementById(`print_a4_score_${itemId}`);
            
            if (naCheckbox.checked) {
                scoreSelect.value = '';
                scoreSelect.disabled = true;
                bandDisplay.innerHTML = '<span style="color: #94a3b8;">N/A</span>';
                printScore.textContent = 'N/A';
                if (printA4Band) printA4Band.innerHTML = '<span style="color: #94a3b8;">N/A</span>';
                if (printA4Score) printA4Score.textContent = 'N/A';
            } else {
                scoreSelect.disabled = false;
                bandDisplay.textContent = band;
                printScore.textContent = '';
                if (printA4Band) printA4Band.textContent = band;
                if (printA4Score) printA4Score.textContent = '';
            }
            
            calculateResults();
            saveData();
        }

        // 计算结果
        function calculateResults() {
            let totalBand = 0;
            let totalScore = 0;

            assessmentData.forEach(section => {
                section.items.forEach(item => {
                    const naCheckbox = document.getElementById(`na_${item.id}`);
                    const scoreSelect = document.getElementById(`score_${item.id}`);
                    
                    if (naCheckbox.checked) {
                        // 不适用，不计入
                    } else if (scoreSelect.value !== '') {
                        totalBand += item.band;
                        totalScore += parseInt(scoreSelect.value);
                    }
                });
            });

            const percentage = totalBand > 0 ? Math.round((totalScore / totalBand) * 100) : 0;

            document.getElementById('totalBand').textContent = totalBand;
            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('percentageValue').textContent = percentage;
            
            // 更新打印版
            const printA4TotalBand = document.getElementById('print_a4_totalBand');
            const printA4TotalScore = document.getElementById('print_a4_totalScore');
            const printA4Percentage = document.getElementById('print-a4-percentageValue');
            
            if (printA4TotalBand) printA4TotalBand.textContent = totalBand;
            if (printA4TotalScore) printA4TotalScore.textContent = totalScore;
            if (printA4Percentage) printA4Percentage.textContent = percentage;
        }

        // 保存数据到localStorage
        function saveData() {
            const data = {
                observer: document.getElementById('observer').value,
                date: document.getElementById('date').value,
                teacher: document.getElementById('teacher').value,
                className: document.getElementById('className').value,
                subject: document.getElementById('subject').value,
                topic: document.getElementById('topic').value,
                comments: document.getElementById('comments').value,
                scores: {}
            };

            assessmentData.forEach(section => {
                section.items.forEach(item => {
                    data.scores[item.id] = {
                        score: document.getElementById(`score_${item.id}`).value,
                        na: document.getElementById(`na_${item.id}`).checked
                    };
                });
            });

            localStorage.setItem('classObservationData', JSON.stringify(data));
            
            // 更新打印版数据
            updatePrintData();
        }

        // 更新打印版数据
        function updatePrintData() {
            // 更新基本信息
            document.getElementById('print-a4-observer').textContent = document.getElementById('observer').value;
            document.getElementById('print-a4-date').textContent = document.getElementById('date').value;
            document.getElementById('print-a4-teacher').textContent = document.getElementById('teacher').value;
            document.getElementById('print-a4-className').textContent = document.getElementById('className').value;
            document.getElementById('print-a4-subject').textContent = document.getElementById('subject').value;
            document.getElementById('print-a4-topic').textContent = document.getElementById('topic').value;
            document.getElementById('print-a4-comments-content').textContent = document.getElementById('comments').value;
            
            // 更新分数
            assessmentData.forEach(section => {
                section.items.forEach(item => {
                    const scoreSelect = document.getElementById(`score_${item.id}`);
                    const naCheckbox = document.getElementById(`na_${item.id}`);
                    const printA4Score = document.getElementById(`print_a4_score_${item.id}`);
                    const printA4Band = document.getElementById(`print_a4_band_${item.id}`);
                    
                    if (naCheckbox && naCheckbox.checked) {
                        if (printA4Score) printA4Score.textContent = 'N/A';
                        if (printA4Band) printA4Band.innerHTML = '<span style="color: #94a3b8;">N/A</span>';
                    } else if (scoreSelect && scoreSelect.value !== '') {
                        if (printA4Score) printA4Score.textContent = scoreSelect.value;
                    } else {
                        if (printA4Score) printA4Score.textContent = '';
                    }
                });
            });
            
            calculateResults();
        }

        // 从localStorage加载数据
        function loadData() {
            const savedData = localStorage.getItem('classObservationData');
            if (!savedData) {
                calculateResults();
                updatePrintData();
                return;
            }

            const data = JSON.parse(savedData);

            document.getElementById('observer').value = data.observer || '';
            document.getElementById('date').value = data.date || '';
            document.getElementById('teacher').value = data.teacher || '';
            document.getElementById('className').value = data.className || '';
            document.getElementById('subject').value = data.subject || '';
            document.getElementById('topic').value = data.topic || '';
            document.getElementById('comments').value = data.comments || '';

            assessmentData.forEach(section => {
                section.items.forEach(item => {
                    if (data.scores && data.scores[item.id]) {
                        const itemData = data.scores[item.id];
                        document.getElementById(`score_${item.id}`).value = itemData.score || '';
                        document.getElementById(`na_${item.id}`).checked = itemData.na || false;
                        
                        if (itemData.na) {
                            handleNAChange(item.id, item.band);
                        } else if (itemData.score) {
                            document.getElementById(`print_score_${item.id}`).textContent = itemData.score;
                        }
                    }
                });
            });

            calculateResults();
            updatePrintData();
        }

        // 重置表单
        function resetForm() {
            if (!confirm('确定要重置所有数据吗？此操作不可恢复。')) {
                return;
            }

            document.getElementById('observer').value = '';
            document.getElementById('date').value = '';
            document.getElementById('teacher').value = '';
            document.getElementById('className').value = '';
            document.getElementById('subject').value = '';
            document.getElementById('topic').value = '';
            document.getElementById('comments').value = '';

            assessmentData.forEach(section => {
                section.items.forEach(item => {
                    document.getElementById(`score_${item.id}`).value = '';
                    document.getElementById(`na_${item.id}`).checked = false;
                    document.getElementById(`score_${item.id}`).disabled = false;
                    document.getElementById(`band_${item.id}`).textContent = item.band;
                    document.getElementById(`print_score_${item.id}`).textContent = '';
                    
                    // 重置打印版
                    const printA4Score = document.getElementById(`print_a4_score_${item.id}`);
                    const printA4Band = document.getElementById(`print_a4_band_${item.id}`);
                    if (printA4Score) printA4Score.textContent = '';
                    if (printA4Band) printA4Band.textContent = item.band;
                });
            });

            localStorage.removeItem('classObservationData');
            calculateResults();
            updatePrintData();
        }

        // 导出PDF
        function exportPDF() {
            // 确保打印版数据是最新的
            updatePrintData();
            alert('请在打印对话框中选择"另存为PDF"或"Microsoft Print to PDF"来导出PDF文件。');
            window.print();
        }

        // 页面加载时初始化
        window.onload = function() {
            initAssessmentTable();
        };
    </script>
</body>
</html>